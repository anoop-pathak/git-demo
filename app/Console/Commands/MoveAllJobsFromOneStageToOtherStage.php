<?php
namespace App\Console\Commands;

use Illuminate\Console\Command;
use App\Models\Company;
use App\Models\User;
use App\Models\Job;
use Illuminate\Support\Facades\App;


class MoveAllJobsFromOneStageToOtherStage extends Command {

	/**
	 * The console command name.
	 *
	 * @var string
	 */
	protected $name = 'command:move_all_jobs_from_one_stage_to_other_stage';

	/**
	 * The console command description.
	 *
	 * @var string
	 */
	protected $description = 'Move jobs from one stage to other stage.';

	/**
	 * Create a new command instance.
	 *
	 * @return void
	 */
	public function __construct()
	{
		parent::__construct();
	}

	/**
	 * Execute the console command.
	 *
	 * @return mixed
	 */
	public function fire()
	{
		$companyId	= 98;

		$company = Company::findOrFail($companyId);
		$systemUser = User::where('company_id', $companyId)
			->where('group_id', User::GROUP_ANONYMOUS)
			->first();

		$scope = setAuthAndScope($systemUser->id);

		if(!$scope) return false;

		$jobs = Job::where('company_id', $companyId)
			->whereNull('parent_id')
			->excludeLostJobs()
			->select('jobs.*')
			->whereIn('jobs.id', $this->getJobIds())
			->get();

		$jobProjectService = App::make(\App\Services\Jobs\JobProjectService::class);

		$count = 0;
		$totalJobs = $jobs->count();
		foreach ($jobs as $job) {
			$jobProjectService->manageWorkFlow($job, '499189128', false);
			$count = $count + 1;
			$this->info("Job ID {$job->id}, Job Number {$job->number} moved to new stage");
		}

		$this->info("Total {$count} out of {$totalJobs} jobs moved to new stage");
	}

	public function getJobIds()
	{
		return [527594, 524256, 507714, 502337, 498712, 492779, 492686, 484096, 481320, 462752, 461623, 459628, 457878, 455870, 454404, 454265, 451164, 450711, 448340, 444505, 443914, 441775, 441262, 440363, 440349, 440328, 440061, 439625, 437421, 436762, 436710, 436039, 435281, 434509, 434494, 434149, 434044, 433745, 433604, 433034, 433018, 432999, 432791, 429586, 428018, 427701, 424850, 424799, 422030, 421995, 421285, 420842, 419476, 419362, 419029, 418264, 418224, 413462, 413452, 413439, 412878, 411841, 411283, 411010, 410329, 409391, 409065, 406759, 405464, 405455, 404880, 403748, 402191, 379029, 379005, 377585, 377403, 377348, 376267, 372862, 372819, 372417, 368433, 368098, 366798, 363023, 362168, 361576, 361404, 361358, 361353, 361330, 360182, 360027, 356840, 356351, 355770, 354427, 353938, 353803, 353517, 352202, 351962, 351791, 351721, 348794, 348511, 348279, 346188, 343484, 343385, 343292, 342207, 340363, 340173, 339689, 339545, 338598, 338523, 337033, 336877, 336865, 336014, 335925, 334918, 334881, 333356, 333352, 333343, 333124, 333052, 331291, 330606, 330406, 329977, 328842, 328192, 328146, 326149, 324738, 324126, 324114, 324006, 323709, 323663, 322107, 322087, 321232, 320805, 320742, 320061, 319981, 319209, 318934, 318085, 318000, 317943, 317714, 317178, 316726, 314936, 314821, 314469, 313881, 313354, 312274, 312143, 311667, 311394, 311369, 310319, 310061, 309240, 307224, 305933, 305771, 305029, 304994, 304959, 304945, 304937, 303896, 302745, 302303, 301865, 301094, 301017, 299806, 299300, 299152, 297209, 296821, 296287, 295225, 295215, 294974, 294915, 294255, 294121, 292941, 292548, 291608, 291310, 290557, 290028, 289986, 289916, 289867, 288335, 287873, 287853, 287805, 287086, 286505, 286338, 286256, 285913, 285498, 284898, 284838, 284665, 283982, 282569, 282539, 281800, 281661, 281652, 281267, 281101, 280062, 279331, 279232, 279206, 278859, 278800, 278287, 278261, 278145, 278123, 277887, 277802, 276367, 276363, 276356, 276318, 276037, 275023, 274953, 274858, 274570, 274353, 274223, 273728, 272657, 272645, 272637, 272636, 271482, 270998, 270059, 270029, 269680, 269536, 269516, 269491, 269484, 269475, 269465, 269262, 269086, 269081, 269073, 269069, 268752, 268735, 268719, 268700, 268692, 268689, 268667, 268642, 268624, 268588, 268472, 268140, 266627, 263743, 263634, 263502, 263452, 263437, 263205, 263140, 263016, 263014, 263009, 262268, 261847, 261367, 261355, 261347, 261089, 261076, 260520, 260391, 260073, 259528, 259237, 258749, 258614, 258478, 258102, 257363, 257009, 256930, 256811, 256588, 256383, 256256, 256249, 256065, 256004, 255619, 255614, 255529, 255518, 255503, 255474, 255453, 254969, 254923, 254392, 254317, 254304, 254138, 254104, 254085, 254075, 253644, 253627, 253618, 253495, 253476, 252416, 252226, 251986, 251966, 251949, 251928, 251923, 251888, 251880, 251871, 251867, 251856, 251731, 251729, 251705, 251688, 251317, 251313, 251187, 250765, 250752, 250345, 250223, 249841, 249816, 249807, 249720, 249693, 249678, 249407, 249256, 248919, 248917, 248914, 248911, 248902, 247175, 247053, 247050, 246631, 246461, 246412, 246349, 246056, 245945, 245815, 245738, 245629, 245586, 245554, 245511, 244647, 244574, 244136, 244120, 243495, 242250, 242182, 242125, 242115, 242091, 240583, 239955, 237765, 237759, 237755, 237749, 237744, 237489, 237472, 237465, 237433, 236584, 236098, 236092, 235930, 235805, 235703, 235630, 235625, 235621, 235612, 235596, 235591, 235525, 235468, 235339, 235099, 234896, 234893, 234884, 234877, 234863, 234440, 234107, 234065, 233825, 233761, 233743, 233728, 233683, 233670, 233655, 233420, 233415, 233412, 233236, 233166, 232906, 232897, 232888, 232826, 232062, 231810, 231789, 231705, 231698, 231156, 230996, 230991, 230975, 230968, 230372, 230362, 230349, 230333, 230328, 230316, 230312, 230132, 229954, 229950, 229946, 229938, 229902, 229866, 229552, 229499, 229454, 229442, 229230, 229223, 228989, 228708, 228396, 228078, 228056, 228045, 228034, 228028, 228022, 228018, 227978, 227972, 227931, 227894, 227541, 226905, 226872, 226747, 226000, 225637, 225634, 225231, 225029, 224965, 224942, 224576, 224572, 224030, 224008, 224004, 223679, 223665, 223253, 223251, 223250, 223080, 223011, 222924, 222829, 222819, 222801, 222796, 222465, 222359, 222346, 222064, 222031, 222014, 221974, 221902, 221622, 221612, 221600, 221594, 221584, 221457, 221407, 221367, 221114, 221083, 221075, 221067, 220999, 220849, 220787, 220725, 220663, 220651, 220409, 220354, 220349, 220256, 220163, 220134, 220127, 220097, 220087, 220071, 220065, 219927, 219926, 219818, 219813, 219733, 219613, 219515, 219430, 219397, 219229, 219220, 219181, 219166, 219145, 219110, 219085, 219066, 219012, 218997, 218917, 218675, 218617, 218587, 218520, 218503, 218478, 218284, 218133, 217934, 217864, 217818, 217714, 217679, 217648, 217638, 217567, 217543, 217289, 217219, 217214, 217053, 217036, 216347, 216322, 216305, 215887, 215863, 215850, 215843, 215820, 215662, 215652, 215623, 215589, 215513, 215507, 215478, 215455, 215405, 215397, 215051, 214639, 214082, 214011, 213840, 213728, 213443, 213429, 213410, 213110, 213099, 213088, 213040, 213032, 213017, 212666, 212304, 212271, 211789, 211786, 211753, 211331, 211267, 211177, 211102, 211064, 211063, 210915, 210909, 210762, 210724, 210576, 210374, 210364, 210069, 210056, 210040, 210000, 209965, 209932, 209748, 209680, 209554, 209538, 209213, 209209, 209198, 209188, 209185, 209014, 208987, 208877, 208804, 208369, 208241, 208222, 208134, 208100, 207906, 207891, 207697, 207682, 207668, 207549, 207504, 207495, 207455, 207138, 207065, 207059, 206945, 206934, 206665, 206580, 206563, 206407, 206396, 206301, 206242, 206227, 206222, 206218, 206188, 205998, 205820, 205577, 205537, 205534, 204863, 204694, 204575, 204571, 204422, 204396, 204365, 204290, 204289, 204132, 204062, 203636, 203619, 203488, 203427, 203422, 203415, 203366, 203272, 202831, 202602, 202512, 202450, 202447, 202438, 202435, 202426, 202346, 202345, 202231, 201684, 201683, 201639, 198715, 196394, 193472, 193455, 193450, 193294, 190932, 189259, 188888, 187171, 187010, 185705, 185469, 185440, 183979, 183267, 183252, 183129, 182549, 181399, 181088, 180152, 178959, 178859, 177675, 177635, 177216, 177207, 177008, 176878, 176612, 176295, 176274, 176263, 175061, 174546, 174385, 172653, 172495, 170579, 168710, 168348, 167913, 167487, 166842, 166786, 166489, 165392, 164829, 164729, 164721, 164435, 164432, 163086, 162957, 162836, 162570, 161896, 161370, 161052, 161050, 160603, 160598, 160597, 160272, 159899, 159253, 158498, 158147, 158023, 157827, 156752, 155981, 152974, 152358, 150103, 148899, 148767, 148669, 148106, 147668, 147662, 147633, 147171, 146768, 143396, 142945, 142467, 142461, 142169, 141629, 140198, 139910, 139904, 138861, 138463, 138272, 138265, 138264, 138215, 137393, 137233, 137077, 136755, 134880, 133995, 133550, 132643, 132236, 131857, 128454, 127492, 126430, 126202, 124247, 123149, 122604, 122534, 122095, 121959, 121727, 119946, 118381, 118237, 114987, 113054, 110847, 109984, 109119, 108165, 107845, 107423, 106444, 105868, 104760, 103943, 103455, 103160, 102733, 101893, 101748, 101485, 100851, 98923, 98476, 98411, 98141, 97531, 97432, 96575, 96074, 95823, 95777, 95745, 95154, 95012, 94939, 94369, 93818, 93813, 93485, 93319, 93299, 92093, 92088, 91718, 90826, 90517, 90261, 89938, 89812, 89166, 88833, 88463, 85748, 85319, 84943, 84816, 83271, 83126, 83123, 81971, 81229, 81179, 81169, 79071, 78724, 78526, 78211, 78095, 77951, 77818, 77817, 77529, 77401, 77190, 77004, 76527, 76212, 75790, 75759, 75096, 75016, 74754, 74580, 74487, 73971, 73788, 73172, 73084, 73011, 72254, 72241, 72207, 72083, 72082, 71698, 71300, 70914, 70268, 70090, 70089, 69970, 69302, 69201, 68320, 67936, 67740, 67468, 67204, 67190, 66971, 66910, 66891, 66555, 66413, 66152, 65722, 64809, 64807, 64720, 64478, 64052, 63835, 63161, 62630, 61970, 60865, 60569, 60247, 60069, 59758, 59618, 59550, 59398, 59299, 58858, 58587, 58464, 57998, 57812, 57660, 57621, 55946, 55466, 55290, 55137, 54769, 54434, 54352, 54204, 54150, 54081, 52504, 52467, 51688, 50795, 50788, 50590, 49288, 49204, 48854, 48634, 48306, 47968, 47717, 47451, 47378, 47356, 47350, 47027, 46939, 46924, 46913, 46522, 46225, 45325, 45322, 45245, 44661, 44281, 44051, 43864, 43799, 43492, 43479, 43399, 43123, 42952, 42775, 42609, 42504, 42359, 42289, 42275, 42119, 42104, 41933, 41930, 41689, 41640, 41621, 41532, 41312, 41306, 41304, 41104, 41100, 40818, 40653, 40472, 40391, 40341, 40009, 39681, 39662, 39414, 39399, 39032, 38413, 37915, 37882, 37864, 37820, 37673, 37657, 37386, 36723, 36258, 36226, 35839, 35742, 35468, 35449, 35438, 35074, 34896, 34868, 34820, 34819, 34777, 34388, 34326, 34227, 34075, 34011, 33988, 33739, 33296, 33218, 32652, 32215, 32160, 31888, 31670, 31349, 31145, 30950, 30899, 30827, 30805, 30555, 30494, 30447, 29980, 29580, 29181, 28623, 28446, 28433, 28062, 28002, 27938, 27883, 27850, 27702, 27603, 27470, 27375, 27335, 27334, 27321, 27263, 27114, 27035, 26928, 26902, 26814, 26726, 26443, 26304, 26224, 25904, 25786, 25709, 25550, 25506, 25365, 24557, 24302, 24227, 23780, 23770, 23768, 23385, 23317, 23262, 23248, 23219, 22972, 22617, 22608, 22567];
	}

}
