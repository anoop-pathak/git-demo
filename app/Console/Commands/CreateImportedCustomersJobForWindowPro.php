<?php
namespace App\Console\Commands;

use Illuminate\Console\Command;
use Carbon\Carbon;
use App\Models\Company;
use App\Models\Customer;
use Illuminate\Support\Facades\DB;
use Exception;
use Illuminate\Support\Facades\Log;
use Solr;

class CreateImportedCustomersJobForWindowPro extends Command
{
	/**
	 * The console command name.
	 *
	 * @var string
	 */
	protected $name = 'command:create_imported_customers_job_for_window_pro_company';

	/**
	 * The console command description.
	 *
	 * @var string
	 */
	protected $description = 'Create jobs for all the imported customers for WindowPro company.';

	private $companyId = 1804;
	private $tradeId = 23;
	private $phones = array(3012835423, 3018141234, 3019384129, 7034058838, 3012925728, 3017859022, 2405054624, 4125234831, 7037253306, 7038539322, 7576183535, 7033995319, 2025776136, 7572296219, 3528703766, 6154807260, 5713448500, 7036232590, 7037801751, 7037511362, 8579396448, 7037861125, 7039677451, 7038233452, 9178828413, 7033792327, 9049236272, 7035958461, 7039017829, 7033733076, 2767341005, 9546291314, 2023213321, 7038955189, 3015389907, 7037517123, 7039448811, 7035482649, 2022713199, 7033384970, 7193519517, 4153094258, 7032543892, 6503801461, 7039636319, 6099700999, 7042778439, 7038558182, 7034038591, 5805951645, 7037803066, 7039095190, 5712445499, 7034098249, 7033995458, 2404478457, 7039664579, 7033390172, 9199232716, 7033249089, 5713099051, 3342211110, 7038998823, 7033717071, 7039750335, 7036836263, 2022513164, 7036710936, 5209075595, 2022775615, 7037866832, 7033501243, 5166399372, 7036151595, 7033341615, 7034020786, 7033705129, 7032983138, 9102731731, 7039288472, 7036710936, 7037800794, 7033091217, 7035877514, 7033704058, 7039995762, 7039940470, 7034077097, 5714319413, 5712255716, 7033609059, 7134448704, 7039312105, 2026647799, 7246815166, 2026748948, 7035829578, 8105139121, 2026804322, 7572142114, 7039899991, 7033173828, 7039469598, 2028704616, 7038613509, 5712368110, 7039650229, 3215054245, 5712771525, 4153094258, 9032447378, 7035480805, 7035072626, 7039719238, 7032971919, 7034890289, 7038231045, 8636693276, 3364023211, 7036273549, 7038238386, 7036240163, 5083337427, 7035498152, 2024133534, 6232256561, 7573752217, 2027781614, 7035982033, 2022057766, 8598020434, 2024130369, 2027510546, 5712773042, 7034725772, 7039272473, 9102632063, 7038192597, 7039602732, 2024913504, 7036067759, 7036228533, 5135097835, 8632580189, 2027814034, 7039227993, 7033508172, 7038689485, 5712328759, 2022940134, 2022153340, 5168502698, 2024508309, 2022575207, 7038631929, 7036243444, 8045647275, 9738681184, 7039692570, 7039066805, 7033289430, 7034475218, 2487093909, 9196164187, 7035875727, 7576183535, 2025283329, 7034746836, 2024841739, 7034987606, 9154222801, 7039606919, 301956-4446, 2024273666, 7036285944, 7036847088, 7172707057, 2404634600, 5712149679, 7036715602, 2023602280, 2038299137, 2023091973, 2024800487, 2029039539, 5403646310, 5409372212, 7039669400, 3015808168, 7034597795, 7034055707, 7039060933, 7035983986, 7037501126, 2022997015, 7037647273, 2243046474, 2026474842, 7032162770, 2403721141, 7034256574, 7039780450, 7037645997, 7039669400, 2022561442, 3018322231, 4106945738, 4124780266, 2022570760, 4102635589, 4107577586, 4107577487, 4108492813, 4845548653, 4438521939, 3013102677, 410703-3231, 4105079901, 4105629016, 4102717127, 4439490278, 3012542030, 4105715677, 3012370920, 4107572601, 8569523769, 4102670599, 4438501311, 410974-1447, 4102791883, 4107570189, 4108970088, 4439958604, 3016758590, 5136009096, 4102630253, 2132579362, 8147530307, 4102631876, 4107571669, 4102667996, 3022368041, 6672250939, 4102129283, 5082373668, 2158373048, 4102800145, 4109560555, 4102667447, 4104096282, 2024606967, 4104875401, 4109719971, 4109740211, 4104047877, 3018077877, 4102688039, 4102630678, 9083342487, 2402710113, 4439944942, 3014521138, 7033144039, 7036067560, 7035225665, 7036090162, 5714380336, 7045644390, 4052272679, 7032036243, 5712187853, 3058906561, 7035360752, 7034729682, 7039892515, 7039690219, 7036156459, 7038592824, 2025316215, 7208002456, 4432436985, 2027638375, 5712322660, 5184297522, 2022310685, 7034245712, 7039925822, 7035271021, 7035340809, 7167257550, 7032162745, 7036279430, 7039312871, 5712750660, 7035176981, 7034658501, 2024686104, 5624858474, 7039093663, 7039675853, 2027419147, 4439550955, 7033444114, 7576357964, 7035257285, 4104585490, 5083336380, 5054004445, 7037311945, 3129333956, 4129999427, 7034860070, 7036279430, 5184249925, 7035215162, 7035539618, 3145500151, 7035337304, 7038013981, 2025503143, 7033147488, 7038192063, 7036249152, 7035369525, 2022310685, 7164250356, 7034860179, 7035983739, 7035338932, 5712828437, 7039097408, 9789440869, 5712137874, 7034720645, 7032445707, 9795836498, 5716999223, 7573771818, 5714240684, 7038921786, 2027541056, 2023203089, 5712057980, 7035327792, 4256792661, 7033959675, 2405813470, 4435103751, 4438480321, 4105441032, 4434406303, 2404015287, 2402222360, 4107573907, 3017287019, 4106477041, 4438480321, 7035814097, 6192099449, 3017855265, 7036875062, 7037296396, 7738755902, 7039488655, 9786217391, 7033070411, 7037249030, 7038352115, 6072393996, 7037297462, 5714422342, 7037296368, 9737691911, 7039996181, 7037297404, 5713449299, 7037285878, 7037324756, 2029975371, 5713420053, 7573193236, 5853154959, 7033070411, 7037291899, 3013253736, 3014769713, 4109005049, 2405155155, 3017741660, 4102363004, 4104763169, 4105927046, 4048958821, 2024224383, 2027976466, 5162386011, 4103770400, 4104587817, 4104640330, 6123333298, 4103776436, 3019048862, 4434621015, 4107466797, 4109524512, 4105308595, 4435629897, 4102789076, 4439950101, 4104407423, 4432863192, 4434133423, 4432506207, 5103327905, 3056098984, 6077430513, 4109488527, 4102062951, 4103024650, 7327575791, 4103407209, 4437628891, 4435672494, 4106753074, 4439098056, 9702901285, 4104197573, 4435068263, 4103712370, 4436109839, 4107181119, 4104670289, 4107332727, 4102278501, 5105019392, 410467-3403, 7577449339, 4102413529, 4109197712, 4109675191, 4128748806, 4107079556, 4436530303, 2487560651, 4437500470, 4102361096, 4437948701, 4104333875, 4109488527, 4107711330, 4439047088, 7326935259, 4438572806, 7039011222, 4102007225, 4109354946, 4436107161, 4109601904, 4102279748, 4434680297, 4102452426, 4438346855, 4435578283, 4433249683, 3017529813, 6672288985, 4105236613, 4436047292, 4109088990, 8083410840, 5182656850, 4109616963, 4439779407, 4104024592, 4108687148, 4109844316, 4102439159, 4109351893, 4103853100, 4434630397, 4436020117, 4432556850, 4107108075, 4109254137, 4103369700, 2162123211, 4048958821, 4107658414, 4104567581, 6178956903, 4103353771, 5102204844, 4109054743, 4439928597, 4104874283, 4108528833, 6172305790, 4252191014, 3365754128, 4437221245, 4106106704, 4104939440, 4104915248, 4437994999, 2022778636, 4438831959, 2167021437, 4437790819, 4103716135, 4108380945, 4102998576, 4108931612, 4104209089, 4104598592, 4106386304, 4434175851, 4109376691, 4106887311, 4106888767, 4108369520, 4108080737, 4436046395, 4104590269, 3019373788, 3013467615, 2404021256, 3015188530, 6782346365, 2404761883, 3019377709, 4102921274, 5409550601, 2403723871, 3014669397, 2029044900, 3015810019, 2023652526, 3013205444, 3015307277, 3014667522, 3017179134, 3015641137, 2407552795, 2024947165, 2402852307, 2023440719, 3012043407, 3019088876, 3019383672, 3019081889, 3016817840, 4434803670, 9739458772, 2024130655, 3013510700, 2406782732, 2024947586, 2022155723, 3018065554, 4435280785, 3013516265, 2026960413, 4107305215, 3018205100, 3015184625, 3017757880, 2024120899, 2027460381, 3014696856, 3014377382, 3013652151, 2026698892, 2483453026, 5082693130, 3017171221, 3015022001, 3013203944, 2029660926, 3018065554, 2026990495, 2024875202, 2026411041, 9083472312, 3019961188, 3018079538, 2405351964, 3016427714, 3015253170, 3012210204, 2029653263, 3015091283, 2406438507, 5714588255, 3015021703, 3014044432, 3057536895, 3014447464, 2024151289, 2029578556, 9176917159, 3016053475, 5127894961, 2404612376, 3013202886, 2027253972, 3012336316, 2026318945, 3013670149, 2023750162, 2406015673, 6178721166, 3015301913, 3012296815, 4437424028, 2023131767, 3013255502, 3013204140, 3012294744, 2404471570, 2022585906, 3015091283, 3012630410, 3024361737, 2403280169, 9173751068, 7032443311, 7032832132, 2408183918, 2404525965, 3016399146, 3042823818, 3019643474, 2407559452, 3013901937, 3015389154, 3017069036, 3018056754, 9177560414, 3012189056, 7032173535, 4345669711, 3018070277, 2406870755, 3012194078, 3012627235, 3018027561, 3013790224, 3012720388, 8608765055, 2025410400, 2403382685, 3018077201, 3018759468, 3018050873, 3017854052, 2025410400, 3019382170, 3017589135, 4432004684, 2404611039, 3017756483, 3013526588, 3017757443, 2406199140, 5408373015, 3019199309, 2026696916, 3019289049, 2025104527, 3015408174, 3018320309, 2026696916, 3015208239, 7033897740, 5853143208, 3012666763, 3015792228, 2077066446, 3012924156, 2024409134, 3013958154, 5717190969, 7033926725, 7035319727, 5713799401, 9044761440, 5713318628, 7038581149, 7037240995, 2672287854, 5712216251, 2404633008, 2023293880, 2488602957, 3019285243, 3015180839, 2402774221, 3015180839, 2406434612, 7036184852, 5712762181, 7034515196, 7034094175, 7034256443, 7039734459, 7033626044, 7032098693, 7032838010, 7032985221, 7036736366, 9104651617, 7036064297, 7034251916, 5713311053, 7032398849, 7035858779, 7034094175, 7034559677, 7034555642, 7033508448, 2402565501, 5087404269, 7038555925, 7035031716, 7033626044, 6145079251, 3014219013, 2402160299, 2409382222, 2404416106, 3018475306, 3014211480, 3057616693, 3018062500, 3014673830, 2029052585, 3135202112, 3013367105, 4108026090, 4102068781, 4103033888, 4105914950, 4432552071, 4439348630, 4106274517, 4439348630, 4103698706, 4438710705, 4438212068, 4102624118, 4107880920, 4109634875, 3017750487, 4404174036, 4107256782, 4104094979, 7036310238, 7039895558, 7035172723, 8479096459, 7036087273, 7032224786, 7039891373, 7032325556, 7038308365, 7038686013, 7036264598, 7608098145, 7039895558, 7033077008, 5712367424, 5712754266, 7033042109, 5713098751, 7039552584, 5208698036, 5713098751, 6146385850, 7032177326, 7032031735, 7039264321, 3016728697, 2408210799, 3018555181, 4102860554, 4105918374, 2174143895, 2405041997, 3013411946, 2406063212, 3017895353, 3018322115, 3013222448, 3013394510, 7036298125, 2026414165, 2404605640, 3014664068, 2023908510, 2027632605, 3016520417, 4156996420, 2028123600, 2025500334, 3014950085, 3016560402, 2025776454, 3016570703, 2022574422, 3016563339, 7036298125, 2028123600, 2023902419, 9174504156, 3017422388, 2024949408, 3015898662, 3018738580, 7034890689, 3012333977, 2403509290, 4105566473, 4432431978, 4107347483, 2408997157, 4105313640, 3056902600, 4103703806, 4105313640, 4105316176, 4105316176, 3013257279, 7038518215, 5715279000, 4436763410, 3056902600, 4103025891, 4105319382, 7035029059, 7034751412, 7036313675, 7032689686, 7035178443, 7033787477, 7039688765, 7036312952, 7037953107, 7039658411, 7038304603, 7035823374, 3018564931, 2029973561, 2152600880, 2404623959, 2406022375, 4438271821, 4105273520, 4433916971, 4104222329, 4106661462, 4109005292, 4434651087, 4105619722, 4107850873, 4102274471, 4107335093, 4438311183, 4439779698, 3013676998, 2403916375, 2408825565, 4434158080, 4104919889, 4103815004, 2406789586, 3018734041, 4438641898, 6073399508, 3015965484, 4109923902, 4107409211, 2177218044, 2404262108, 8603079458, 2406957021, 3013676658, 4432530307, 4107309414, 4103304446, 3012505636, 4434130860, 3013794880, 4107400068, 2409883283, 4107077248, 4102995379, 4436216879, 6023322490, 2408823540, 4437660367, 7039675381, 4109605432, 4103816279, 2405351515, 4432962609, 4107301911, 3107097920, 4109924486, 4109641922, 4107907003, 4436186469, 3015969060, 4102626952, 2409380087, 2022819477, 4107301269, 4109258153, 4105314818, 4103813283, 3018069226, 7708556065, 4109910381, 4105335512, 4109721350, 4432559081, 2405054146, 4109162999, 4104592009, 4435475828, 4436954897, 4107032130, 3017040191, 4109232917, 4434139576, 9102736549, 4109871937, 4105710608, 4439941903, 7573777277, 4433702506, 7039947236, 3014668611, 2408992529, 2404090033, 3017754890, 3014711156, 2406761436, 3019774599, 4107988165, 4107987877, 7038530653, 4109568996, 4104195207, 3012610363, 4107988165, 2402782797, 4789522679, 3013466909, 3015927483, 7032033608, 7039552508, 5402102780, 7034054481, 4023218217, 7033715712, 7035094209, 7034087707, 7039806093, 6178031884, 4102718838, 4107984461, 4103533109, 4107981747, 4109564195, 3018752768, 4432946834, 2158338201, 5712125839, 4107985778, 4107814612, 4102597142, 3013350901, 8083334845, 4109601877, 4103795121, 3868460954, 4102061087, 4438786496, 4435385017, 4102156160, 4433255061, 2404018444, 4104407089, 4104189004, 4104185664, 2403986072, 4102418821, 4104612884, 4439800317, 4435274879, 4438489216, 4107075460, 4107501023, 4432546816, 4107075518, 4104616547, 4432539148, 4438123749, 4103406548, 4432803838, 4439793468, 3013439234, 4434147416, 5408089113, 4107508862, 4437459490, 3014550487, 4108021098, 4103759778, 8023809956, 4105305965, 4102079644, 4434167187, 3014989911, 4436952375, 4105315580, 4432263222, 4107361887, 4109487622, 4102181790, 4104616118, 2026828155, 4436176465, 5712410582, 4104652258, 4108522320, 4107077901, 6076431091, 4102076465, 4105706512, 4102623474, 3013102257, 4105742367, 4437426935, 4436761843, 4107905010, 7034253428, 7167952729, 5713587210, 7035855183, 7036152694, 7187818945, 7184644320, 2025771102, 7184644320, 7038816800, 7032390202, 7033235200, 7035994740, 5712132731, 7039676547, 7033077756, 7033524514, 7033522683, 8139283416, 7037852537, 7039665656, 2026420257, 7039015773, 7034623757, 7034777459, 7038619005, 5713324508, 7035032056, 8153554190, 2022572563, 7039552577, 7039966323, 7039800953, 7038654159, 7036919028, 7035319885, 2406038599, 7035774814, 5712766311, 7032168521, 9089382176, 7033235212, 7247472063, 7039196299, 7034085123, 7034026691, 7039653104, 7039671555, 7033237947, 7036081748, 7038431889, 7038501444, 7032501489, 7039752794, 2022718950, 7034256982, 7039293765, 7036748702, 7573770053, 7039448481, 7032239584, 7036098839, 7036904550, 6812423232, 6812423232, 7035992628, 7032893054, 7037327143, 7039666346, 7033548003, 7032444834, 2026699074, 2246390348, 5712654197, 7037173044, 7035326565, 7134109729, 7037271174, 5165870621, 7033042322, 5719994136, 2027461812, 9294516671, 7032299243, 7032833499, 7035602315, 5714471441, 7036747821, 7032371983, 7034598900, 9788694233, 7032004201, 2022228644, 7032417764, 7035327783, 7039275281, 7039315266, 7038626605, 7038762659, 7034723517, 4155164018, 5714259939, 7035980098, 2025942721, 2022860156, 7038698416, 7034032767, 4436915263, 5174492123, 7034026145, 5712786911, 5717650150, 2404981294, 4432786401, 4436405054, 4104098454, 4436102550, 4108796259, 4103506208, 4434659050, 7865547590, 4108778301, 4103223210, 4108299905, 4438213959, 3013351867, 4102369021, 4109136892, 4104201455, 4107464804, 4108388583, 4435276162, 4109160584, 8315219316, 3017045481, 2407554649, 3016747576, 7572882126, 7032030170, 3012920998, 3012482722, 3012929686, 8085613326, 8315219316, 3015142740, 3014660244, 3018983538, 4438831685, 3016942720, 3016391897, 3018748470, 3016620993, 4103713463, 3013254455, 3014019645, 3017300548, 3019805053, 2404095481, 2403443600, 3017045336, 3015255456, 2404469189, 3014012632, 2403441639, 3019804560, 2402813466, 301524-8084, 2404099548, 5853059888, 3015143125, 3016630721, 3013052234, 3016319122, 3013050233, 6463460695, 3014985927, 3016510711, 3018541432, 301332-6876, 3014908722, 7033508372, 2197413385, 7036234529, 2026311250, 5135462510, 4065482583, 7034058290, 5713381784, 4065482583, 4087187684, 3012333464, 3018691592, 3015291039, 3015091924, 9172322112, 3015278906, 2403930879, 9082561180, 3014670903, 2406719553, 3012199416, 2405521453, 2408010651, 2029047673, 2408993769, 3014820901, 2404982028, 8149312801, 3012531053, 2408999149, 3014619988, 3017751523, 7164408211, 3019478183, 2026697959, 9737150002, 3018699163, 3013181016, 2404911393, 2406878715, 3013326341, 6312587619, 3019434887, 2026697959, 2404775578, 3019800641, 3018213655, 2407795317, 3012213113, 2406435319, 3018070926, 2404269501, 3013322956, 3019917738, 2403728717, 3016410743, 3015294099, 4106726621, 2403930484, 3015294099, 4107218629, 3018694341, 2406872004, 2408057277, 6787567558, 7035684500, 2404267932, 3013530373, 3014283645, 2023786973, 2024383231, 2404839133, 2407932377, 3018694341, 2409884381, 2404412803, 3013702787, 3016019081, 2405862385, 4439156976, 2402810701, 3015256402, 5406645511, 7036090609, 4433362758, 4107612567, 4435919677, 4436377066, 4106364325, 4438677717, 4107662978, 4107613965, 4438651740, 7873070754, 4107770448, 3013328000, 4105313269, 3015186425, 2402066159, 3013510003, 4104045695, 4104890423, 5407525175, 7039436875, 7039758272, 7034757649, 7034784521, 2407312244, 7034019040, 7035070256, 5713342856, 7038651893, 5712594402, 2024987764, 7035812824, 5124226655, 7034500427, 7038551471, 2022360588, 2407312244, 7033363429, 7034304786, 7032831436, 2022853946, 7032822491, 3142494208, 2027449319, 3017878934, 3014419544, 3013353655, 3014741959, 4437174076, 3017791123, 5172811629, 2406254582, 2403138770, 7177652404, 3017303410, 3015148016, 2402176272, 7174227399, 4109173323, 5403383700, 4434877146, 4437893374, 4109633582, 3013950188, 4106910107, 4109260406, 7034021758, 7032834665, 5714478900, 7033800589, 7037532472, 7402603899, 7035870235, 7036293782, 3016132723, 5719262952, 7034040036, 7038601717, 7032166858, 5719262952, 7038609289, 7039673500, 7038505153, 5704015686, 7034353444, 7034719115, 7036555544, 5712137089, 7035999710, 7573483647, 5713146116, 7035935501, 7039305960, 7039898701, 7035317443, 7034339292, 7036279794, 8018142386, 7033429724, 7034027022, 3018540978, 3013266440, 3018542979, 3018543771, 3015792692, 2402542463, 4107037840, 8059755535, 4104145809, 4105355913, 4435328969, 8059755535, 2489749568, 4106107103, 4106106532, 4439682974, 3019276404, 3018737766, 3018533411, 2406878896, 3014120406, 3012775712, 3019222277, 3015430918, 301-606-4720, 2407934933, 3018659588, 3042618045, 9153296615, 4105304647, 3016399332, 3017063222, 3016399332, 4107999954, 4436187700, 3014830197, 4104589063, 4106278137, 7173322998, 4434842923, 4432502786, 4434842923, 6108882361, 3014321969, 3014327277, 4074357748, 2025785423, 3017286989, 3016053176, 3018801187, 3013469880, 3019426406, 3019195327, 3019420041, 2059665998, 2404012736, 3015652545, 2404012736, 3015208847, 5407755789, 5407753668, 4438312885, 3018344701, 3019881296, 3015199000, 3018346116, 7572916165, 7036297231, 3019347051, 2406872508, 3017525189, 3019191634, 3015773807, 3018736901, 3017580118, 3013453656, 3014593281, 3015203825, 3019436886, 3013106970, 2404639113, 3019969836, 3013439473, 7737545983, 3014907299, 3014980155, 3017089787, 3014555803, 3013233320, 3016614553, 3016046056, 3017764146, 3014830354, 9739029742, 4109007814, 3013127458, 2022206916, 4342384233, 3016759451, 2024042701, 2404475525, 3014982835, 2405545846, 3014981810, 3017250067, 4108804846, 3014907211, 4123289934, 3019963011, 3014140173, 7038879142, 7037284159, 703-395-0441, 7034052723, 7037779590, 7034097653, 7037321217, 8152107950, 7037772302, 7039531959, 5712913088, 7033761561, 5713409733, 7206510207, 7037277617, 7272395132, 7037771557, 7037711981, 7038518061, 3014812654, 3012666600, 2409256342, 7039897598, 7035931113, 4109673111, 4106368429, 4108023524, 4106846934, 7038616700, 7033388504, 5714940001, 5712511653, 5713347256, 4108677771, 4108673130, 5706401273, 7033284949, 5714201324, 7038633575, 4439756715, 4438129857, 4432441944, 4107832665, 4108479297, 4103080558, 4108255095, 4102998218, 4439043628, 4439005498, 4435400057, 4439280056, 4102524410, 9176121446, 4102964046, 4106082692, 4105609945, 4105603928, 3025938944, 4436830872, 4434146650, 4439856321, 7246748312, 4439280233, 4437219720, 4439299146, 4434652121, 6032520945, 4102524591, 4103379150, 4105615310, 4108689414, 4109788629, 4438586940, 4103752596, 4106635717, 4434654075, 4102998891, 4102748470, 9178172655, 5162861237, 5713305769, 7033616796, 8155295157, 7033352664, 7038708894, 7037915408, 5712424094, 8083863102, 7033688923, 7033696358, 7034022767, 7039155756, 7037916020, 7034013493, 7038568087, 4802920841, 9144662582, 4108832292, 4437189330, 4438294155, 5403643096, 5308388888, 5403642509, 7039891727, 7036785509, 7037852294, 7038195250, 7038354327, 7035326481, 7033804469, 7033505902, 7036186887, 2024606264, 7036282348, 7037905876, 5714810244, 7035386734, 5712178669, 7032985431, 2022510273, 7036224264, 2023456053, 5712434438, 7034424913, 7038191950, 5712770585, 2024925522, 7037596961, 2026586199, 8625962552, 7038233898, 2024925522, 7035682480, 7036082518, 2022139864, 2022569327, 2032403093, 7037340745, 7033565811, 7035898128, 7033505902, 7034077624, 7038516495, 2029040940, 7036243896, 7035464745, 2024314430, 7034796834, 7038645483, 7038621153, 5087355758, 7038931968, 3018843883, 4103355305, 4435598430, 4105643258, 7038628250, 3016061865, 3012930938, 3014718651, 3013718880, 4435205674, 9103821631, 2405059570, 4436796839, 8564198763, 4103758634, 4104587014, 4109874412, 4108072134, 4109803149, 4439261373, 4109030102, 4102318609, 4109879630, 6083954067, 4109285262, 3013524590, 4102598026, 4104724814, 4104722357, 4436292656, 4432256084, 4436227100, 5405358555, 7038011341, 8437085927, 2404232132, 3012726836, 3015128881, 4104303212, 5712177221, 3013435743, 5133759903, 3012151502, 2404328652, 3016394926, 3016078821, 2403446497, 3018298996, 3018545876, 3016399460, 2407323066, 3019805655, 2403446022, 4437227875, 4433888609, 3024787655, 3015377429, 3014714941, 2404570267, 2022159742, 3018027556, 3018657092, 3014732823, 3014713890, 3016418800, 3012373068, 3014714941, 2406783588, 4436716033, 4103505978, 3012590227, 2025797123, 7037912529, 7033306155, 7039806088, 2405056877, 3018076788, 3017211638, 3016416440, 3014248319, 3012135700, 2402464920, 6463097065, 2402464920, 3014243415, 2403289633, 9739753290, 3013464494, 5854146084, 3018382884, 9083990535, 7039064153, 7036777751, 4106687267, 4439345588, 4437912686, 4109330897, 7034764221, 7038643339, 7033719987, 7032826654, 7033141444, 7036066213, 7036786469, 7032645826, 7039465560, 7032427511, 7032620424, 7035254071, 7032681480, 7032448515, 7032615391, 2147636523, 5303296836, 4102790170, 4439047156, 4106952491, 4105072903, 4105854734, 7068237949, 6142829069, 2406186865, 3018020664, 3013329840, 3019194823, 2404986195, 2023906791, 3019244016, 3017582398, 4109800813, 3017743648, 4434146641, 3017746585, 2027255661, 3016556038, 2404184724, 3016519167, 2409978995, 3013329840, 3018557419, 3012757411, 5033967729, 3016028618, 4105816731, 4106277738, 4103031165, 4103565839, 4102369790, 4437228967, 4437170712, 4102187104, 4438318719, 4109026353, 2106278499, 2404911115, 3016860990, 2106278499, 4103574827, 4437943639, 4439923616, 7173322130, 4103826619, 4434143388, 4436103249, 4106686873, 3015243805, 6304859626, 4439280262, 4104374868, 4106279253, 4435699536, 4432235911, 4436180205, 4107072832, 4102718259, 4103607033, 4436945737, 4104374335, 4438229104, 7244221776, 4108045194, 4104376890, 4436188103, 4438447160, 4102995686, 4107908742, 6107517652, 4102929444, 4435177180, 4105985284, 4108775109, 4109672274, 4105049125, 4432863334, 4434218098, 4104841713, 4103032411, 4437915242, 4109351640, 4438452058, 6462061713, 4104844422, 2406201425, 3015807177, 2398777113, 3012519377, 3012314860, 2403884656, 3017582385, 3013408432, 3019082822, 3012992994, 9199000959, 3014088483, 3014694954, 2407503479, 3012545446, 2025278125, 2407538106, 3015300948, 3019830575, 3015099943, 3019384784, 3016020955, 2402416883, 3013326033, 3015294144, 3012575695, 3059626439, 3012992632, 7036289134, 3015181828, 2402172003, 3015208555, 2403724314, 3019288564, 2409942251, 2404000350, 3019432734, 2406442288, 3017870330, 2405066556, 3017898114, 3016025861, 3015262626, 2022460617, 3015387080, 7037491001, 7708564135, 3016131074, 3014614904, 3012371314, 4432866995, 3016741690, 3016020955, 3019438142, 7037596664, 2404181118, 2028532503, 8143306826, 3019807657, 2404418857, 3016467549, 3019832476, 3013406856, 2404815711, 7818564130, 2024686988, 2408762612, 3016338049, 3012795694, 3019269765, 7039993794, 4104742841, 4102311456, 4106100190, 5402952757, 2023099153, 5402952757, 5403381854, 7039155948, 2402777139, 7034313848, 7036236605, 7038695205, 4109220432, 4109226096, 4104049003, 4433862939, 4107368700, 4105264951, 4102524025, 4432531649, 4107368700, 2404950651, 4439520100, 4434148615, 4432049224, 5712050260, 5713103795, 2022854980, 7034761667, 7036899780, 3168413940, 7037720403, 7034750087, 7034027525, 7039672415, 2103638464, 5713085624, 5712461617, 7034055250, 7032421718, 7037329632, 7034307682, 5712124328, 7575722885, 7032619599, 7034819316, 7032014236, 7034766324, 7036893951, 7034711291, 7039152209, 7038603316, 3012132086, 7034373153, 7035938753, 7576214076, 7038608213, 5714470475, 7034357794, 3017680082, 7037257995, 7037593352, 7037987675, 7036597081, 7034766324, 5714903249, 7039892086, 7038621682, 7034706805, 4105702352, 4109564906, 3012773194, 3018734917, 2404617728, 3012376442, 2404953132, 3017043708, 2404267076, 7036354428, 9176564927, 8082307858, 3017753165, 3015026500, 2024122839, 3016421986, 8285073959, 3019287670, 3016428645, 4056377270, 3019299400, 3016107424, 3019299628, 3017553941, 2404498887, 2405388282, 3018811026, 3014670664, 3017703858, 2406273494, 3014939383, 2025782661, 3013401880, 4845293154, 3017755539, 3012376442, 9492756362, 9737696396, 2403701886, 3016565635, 3019243671, 2404415848, 9176564927, 3019790144, 2024060302, 2023025529, 4048778848, 7194520962, 2023906697, 3015184764, 7342761424, 3018819895, 3016565635, 3014518783, 4437457860, 9199238478, 4103917658, 4102077144, 4102077144, 7034704614, 8622667727, 3014485651, 2404609041, 4105913928, 4105190120, 5403229956, 3013329079, 4109692029, 4105195804, 5126380424, 4439289732, 4105445746, 4436182630, 4105075511, 4439946799, 3192306746, 4106472814, 4436038967, 4437143974, 6175013166, 4102799905, 4437143974, 3016810288, 3016258756, 2403898882, 3014371885, 3015806451, 3014769773, 3017852599, 2024154050, 3013258001, 2023092038, 3014666733, 3019430136, 3015653840, 3014616757, 3015854242, 5157792655, 3014373974, 3015809591, 3015128475, 7034475487, 2167019823, 3019802801, 3017938975, 2402632686, 3013674467, 2403813928, 3015930942, 3013844445, 2023095230, 3015620324, 3017853568, 3016492396, 3014422675, 3014225713, 2402743974, 6176409891, 3013841069, 4435578189, 3014616757, 3018904141, 3015870417, 6109096654, 3015983630, 3018792843, 3018799442, 3019495793, 7346258282, 3016461317, 3015373586, 7164324665, 3017882508, 5109150074, 2027448060, 3016027505, 4436151522, 6468728496, 2025507672, 2404726764, 4109255265, 4105918493, 7039290675, 4107330703, 4109776532, 4104724312, 4104911695, 3014211425, 3016469709, 3014208329, 7039559046, 7034749005, 7038988180, 7065108087, 7034756186, 7039136311, 2548138921, 2024136626, 7034510526, 7038960120, 7034510301, 7039133250, 5712323334, 7035690941, 6462065401, 3107450136, 7036447811, 7036444031, 4025418565, 7039139490, 2027010222, 7345361944, 7038664708, 7033108055, 7033004355, 5712258577, 7034472106, 5712786510, 7034515028, 7039274080, 7035973778, 7033549543, 7036297742, 7034556232, 2028151992, 7033004355, 7033549543, 7038649774, 7037275008, 7577058281, 8155145984, 2168492097, 7034704969, 7032325858, 5714261479, 5712165299, 5714265134, 7034304395, 7038507343, 7034219197, 4104194289, 5037541037, 4843431543, 4104566906, 4104529755, 4108648210, 3017020742, 2024151688, 4432808820, 2404808509, 4103706346, 2402789616, 4107950470, 4104582340, 4438581318, 4107956970, 4432808355, 8609309382, 4109606225, 4107954361, 4102745799, 8034140541, 2672284714, 3017874037, 3012705107, 2404788858, 3015376192, 2025250454, 2023296066, 2402740341, 3014525712, 3013791815, 3018991443, 4124011347, 4103656347, 3016067776, 4103656347, 3012713611, 3012714637, 4102524457, 4102528522, 4109631032, 4108021095, 4438345386, 4109670675, 4103036655, 4108253615, 4434252346, 4102992355, 4438545877, 4109163331, 4104998704, 4108287328, 4108218856, 4102366535, 4108252503, 4435095001, 4438239572, 4107335756, 4108234900, 6178998763, 4103822708, 4437909662, 4102994531, 5183204084, 4104941193, 6178998763, 2024319994, 3016274415, 9173484769, 2404321668, 3017582805, 4108049041, 4436395314, 4436134857, 4432508472, 3013505301, 3019962816, 3015370894, 2406019249, 3017808920, 3014565302, 3013955440, 3012491171, 3017415972, 2404620302, 3014209496, 3017415972, 2023521212, 3013245602, 3018681612, 3019281391, 3015997890, 2408020596, 7035370065, 7032551328, 5713754467, 7032559851, 7036201611, 7038191912, 7037257411, 6104628473, 7036276771, 5712968137, 5712368107, 2679946852, 7032559477, 5712286813, 7036420249, 7037160097, 2403937472, 2022134891, 2025502160, 7033952975, 7036260846, 7033362727, 7037722780, 7038351107, 5712420397, 7035878031, 2024372490, 7034084633, 8433670273, 7037259260, 7037599558, 7036917668, 7032983129, 7035089320, 7039382023, 7038437720, 8605737103, 5715289251, 7039383211, 7039302446, 7036748695, 7039380821, 7033136825, 7034009523, 5713890151, 7032983129, 7037160097, 3019069809, 3016451065, 3018140043, 3017057604, 3016451462, 2403982071, 3018705810, 3017524624, 3013258431, 3018882268, 2402854768, 3017484018, 3017883313, 3016060505, 4439856529, 2405930953, 5403493274, 7033147861, 7034024113, 5712741058, 5712121713, 3014426615, 3016511251, 4108673558, 4108488780, 4109609292, 4108766007, 4438054380, 4439527970, 4437899956, 3016390351, 5306754268, 4436176802, 5406650692, 5713616998, 7033148010, 5403130349, 5405393449, 5406860779, 7034701632, 4103036062, 4102657160, 4103032447, 4436217656, 4104897401, 4439968578, 4104897625, 4432869757, 3036384252, 4437621397, 3373963907, 9316241859, 7035900835, 5713274579, 7039150408, 7039191650, 5712392502, 5402263981, 7039442710, 7035072639, 7036705592, 7034755242, 7038997514, 4072801445, 7037639483, 5405292592, 7037726072, 7037639483, 9419322763, 7035900870, 7036154505, 7036597305, 6789258105, 7036557571, 7854105315);

	private $createdDate = "2020-11-06";

	/**
	 * Create a new command instance.
	 *
	 * @return void
	 */
	public function __construct()
	{
		parent::__construct();
	}

	/**
	 * Execute the console command.
	 *
	 * @return mixed
	 */
	public function fire()
	{
		$company = Company::findOrFail($this->companyId);
		$anonymous = $company->anonymous;
		setAuthAndScope($anonymous->id);
		$startedAt = Carbon::now()->toDateTimeString();
		$this->info("Command started at: ".$startedAt);

		$query = Customer::where('company_id', $this->companyId)
			->whereIn('id', function($query){
				$query->select('customer_id')->from('phones')->whereIn('number', $this->phones);
			})->whereNotIn('id', function($query) {
				$query->select('customer_id')
					->from('jobs')
					->where('company_id', $this->companyId)
					->join('job_trade', 'job_trade.job_id', '=', 'jobs.id')
					->where('trade_id', $this->tradeId);
			});

		$this->saveCustomerJobs($query);

		$completedAt = Carbon::now()->toDateTimeString();
		$this->info("Command completed at: ".$completedAt);
	}

	private function saveCustomerJobs($query)
	{
		$queryClone = clone $query;
		$queryClone->chunk(50, function($customers) {
			foreach ($customers as $customer) {
				DB::beginTransaction();
				try {
					$this->createCustomerJob($customer);
					Solr::customerIndex($customer->id, $customer);
					// $this->info("Job created for customer id: ".$customer->id."\n");
					DB::commit();
				} catch (Exception $e) {
					Log::info("Create Import Customer Job for WindowPro. Error: ". $e->getMessage());
					Log::error($e);
					DB::rollback();
					$this->info("Job not created for customer id: {$customer->id}. Error: ".$e->getMessage());
				}
			}
		});

		if($query->count()) {
			$this->saveCustomerJobs($query);
		}
	}

	private function createCustomerJob($customer)
	{
		$customerController = app(CustomersImportExportController::class);

		$data = [
			'trades' => (array)$this->tradeId,
			'description' => "2019 PELLA PC",
			'customer_id' => $customer->id,
			'contact_same_as_customer' => true,
			'same_as_customer_address' => true,
		];

		$jobData = $customerController->execute("\App\Commands\JobCreateCommand", ['input' => $data]);
	}

}
